---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro'; // Layout global del proyecto

export async function getStaticPaths() {
  // Obtener la colección de proyectos
  const projects = await getCollection('projects');

  // Crear rutas dinámicas basadas en los archivos de la colección
  return projects.map((project) => ({
    params: { project: project.slug }
  }));
}

// Obtener los datos del proyecto actual
const { project } = Astro.params;
const projects = await getCollection('projects');
const currentProject = projects.find((p) => p.slug === project);

// Agregar redirección o manejo de error si el proyecto no existe
if (!currentProject) {
  return Astro.redirect('/404');
}

// Solo realizar el render si tenemos un proyecto válido
const { Content } = await currentProject.render();
---

<Layout title={`Proyecto: ${currentProject.data.title || 'Sin título'}`}>
    <body class="dark"> <!-- Aplica modo oscuro a toda la página -->
  
      <article class="prose lg:prose-lg max-w-none dark:prose"> <!-- Se agrega la clase "dark:prose" -->
          <!-- Aquí se renderiza el contenido del archivo Markdown -->
          <Content />
      </article>
      
    </body>
</Layout>


<style is:global>
    .prose h1 { 
      @apply text-3xl font-bold text-gray-300 mb-4 mt-8; /* Ajuste a un tono más claro */
    }
    .prose h2 { 
      @apply text-2xl font-semibold text-gray-400 mb-4 mt-8; /* Más claro para resaltar en dark mode */
    }
    .prose h3 { 
      @apply text-xl font-semibold text-gray-500 mb-3 mt-6; 
    }
    .prose p { 
      @apply mb-4 text-gray-300; /* Texto principal más claro en modo oscuro */
    }
    .prose ul { 
      @apply list-disc list-inside mb-4; 
    }
    .prose ol { 
      @apply list-decimal list-inside mb-4; 
    }
    .prose li { 
      @apply mb-2 text-gray-300; /* Asegura que los elementos de la lista sean claros también */
    }
    .prose strong { 
      @apply text-gray-400; /* Texto en negrita con color más claro */
    }
    .prose a { 
      @apply text-gray-300 hover:text-gray-500 underline; /* Enlaces con buen contraste en dark mode */
    }
    .prose code { 
      @apply bg-gray-800 text-gray-200 px-1 py-0.5 rounded; /* Fondo más oscuro para el código */
    }
    .prose pre { 
      @apply bg-gray-800 p-4 rounded-lg overflow-x-auto; /* Fondo oscuro para los bloques de código */
    }
    .prose pre code { 
      @apply bg-transparent text-gray-200; /* Código dentro de bloques `pre` legible en modo oscuro */
    }
    .prose blockquote { 
      @apply border-l-4 border-gray-600 pl-4 italic text-gray-400; /* Citas con borde claro */
    }
    .prose table { 
      @apply w-full border-collapse border border-gray-700 mb-4; /* Bordes suaves para tablas */
    }
    .prose th, .prose td { 
      @apply border border-gray-700 p-2; /* Bordes suaves para las celdas */
    }
    .prose th { 
      @apply bg-gray-700 font-semibold text-gray-300; /* Cabeceras de tabla con fondo y texto contrastante */
    }

    .prose img {
      @apply max-w-4xl h-auto mb-4 rounded-lg shadow-md; /* Ajustes para que las imágenes sean responsivas, con margen, esquinas redondeadas y sombra */
    }
  </style>

